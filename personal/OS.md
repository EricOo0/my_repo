# 计算机上电到启动的过程发生了什么  （操作系统和硬件）
```
接通电源前，系统CPU 处于实模式，寻址空间为16位，cs（段寄存器）和ip（偏移寄存器）都指向固化在rom中的BIOS程序
接通电源，系统指向BIOS程序，进行硬件的检测和初始化，然后将磁盘0磁道0扇区的代码读入内存（OS的代码），设置cs和ip指向os的bootsect.s代码,控制权交os
bootsect.s引导操作系统，导入setup.s代码到指定位置，setup设置内存等一系列操作，将操作系统代码移动到0地址处，并进入保护模式（32位寻址）
执行system模块的代码，初始化os，操作系统开始执行main函数
--setup.s时候读取的内存参数在这时候初始化时用于设置mmap数组，指示哪些内存已使用，哪些内存未使用
```

# 操作系统的接口————系统调用  （应用程序和操作系统）
```
操作系统分为用户态和内核态，用户态代码不能访问内核态代码，这是由硬件设定好的：执行代码是会检查DPL（目标特权级） CPL（目前特权级），满足CPL<=DPL才能执行
（用户态可以直接访问内核态是不安全的）
只能通过中断来从用户态进入内核态（INT 0x80），由系统调用实现
用户态代码-->调用system_call函数（比如wirte（））-->system_call设置中断置0x80-->触发软中断，进入内核态-->根据调用号去找对应的中断处理函数，执行对应操作-->返回用户态

```

# CPU管理 1
```
CPU功能：取值执行，从内存中一条条取代码，执行代码。
进程的概念：运行着的程序就是进程
CPU是管理进程的设备，管理CPU实际上就是管理进程，但是IO指令速度远远小于计算指令，单进程执行的化CPU效率很低
因此有了并发的概念：并发--让一个CPU交替执行多个进程，不在等待IO上浪费时间；CPU管理并发的多个进程是CPU管理的关键

进程的切换执行依赖于PCB（process control block），每个进程都有一个PCB表，存放着上下文信息，用于保护现场。进程切换时将cpu运行信息压入PCB，将要切换的进程PCB换到CPU中，完成进程切换
进程的状态：运行态 就绪态 等待/阻塞态
CPU维持三个队列 运行队列 就绪队列 等待队列，队列的头尾指针各自指向对应进程的PCB，用于进程的切换
队列的维持方式取决于调度方式--队列操作+调度+切换！

进程同步：进程之间可能共享一些资源，进程切换可能导致资源更新出错，需要进行同步，常见方法：加锁

linux系统进入main函数后，调用fork创建第一个进程（1号进程），启动shell，后续的所有其他进程都由这个1号进程产生。

```